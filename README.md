# FuncXauusd v1.1 - Production ML Trading System

> –ö–ª–∞—Å—Ç–µ—Ä–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ ATR-—É—Ä–æ–≤–Ω—è–º–∏ –∏ —Å–∏—Å—Ç–µ–º–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏

## üéâ –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v1.1

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ) - –ì–û–¢–û–í–û
- ‚úÖ **Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è** (`src/validation/walk_forward.py`)
  - –†–∞–∑–±–∏–µ–Ω–∏–µ In-Sample –Ω–∞ 10 –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ Out-of-Sample –±–ª–æ–∫–∞—Ö –≤ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
  - –†–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —à—É–º–∞
  - –£—Å–∏–ª–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö

- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SL/TP –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR** (`src/risk/atr_manager.py`)
  - –†–∞—Å—á–µ—Ç Average True Range –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–∞—Ä–∞
  - SL = Entry ¬± (2.0 * ATR), TP = Entry ¬± (2.5 * ATR)
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: Position = (Capital * Risk%) / SL_Distance
  - –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —É—Å–ª–æ–≤–∏–π –ø–æ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏** (`src/monitoring/degradation.py`)
  - –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ –ø—Ä–æ—Å–∞–¥–∫—É > 120% –æ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–π
  - –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ —Å–µ—Ä–∏—é –∏–∑ 10 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
  - –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ < 50% –æ—Ç –æ–∂–∏–¥–∞–µ–º–æ–π
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–£–ª—É—á—à–µ–Ω–∏—è) - –ì–û–¢–û–í–û
- ‚úÖ **–ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏** (`src/features/multiframe.py`)
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 1m, 5m, 15m, 30m, H1, H4, D1, W1, MN
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Ä–∞–∑–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
  - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: –ø–æ–∑–∏—Ü–∏—è –≤ High/Low range, —Ç—Ä–µ–Ω–¥—ã, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

#### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (Production) - –í –†–ê–ó–†–ê–ë–û–¢–ö–ï
- ‚è≥ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (–∫–∞–∂–¥—ã–µ 6 –º–µ—Å.)
- ‚è≥ CI/CD pipeline
- ‚úÖ –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (pytest) - –±–∞–∑–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

Production-ready —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π ML-—Å–∏—Å—Ç–µ–º—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ CatBoost —Å:
- **–î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π**: Main model (—Ç–æ—Ä–≥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã) + Meta model (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤)
- **Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π**: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤ —Å —Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–æ–º**: ATR-based Stop-Loss –∏ Take-Profit
- **–°–∏—Å—Ç–µ–º–æ–π –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
- **–ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–æ–≤–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π**: –æ—Ç 1m –¥–æ 1Month
- **ONNX —ç–∫—Å–ø–æ—Ä—Ç–æ–º**: –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å MetaTrader 5

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–æ–º–µ—Å—Ç–∏—Ç–µ CSV —Ñ–∞–π–ª—ã –≤ `data/raw/`:
```
XAUUSD_H1.csv     # –û—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º—Ñ—Ä–µ–π–º
XAUUSD_D1.csv     # –î–Ω–µ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–ª—è –º—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–∞)
XAUUSD_W1.csv     # –ù–µ–¥–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–ª—è –º—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–∞)
XAUUSD_MN.csv     # –ú–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–¥–ª—è –º—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–∞)
```

–§–æ—Ä–º–∞—Ç CSV (MT5):
```
Date;Open;High;Low;Close;Volume
2004.06.11 00:00;389.50;390.00;388.75;389.25;1250
```

### 3. –û–±—É—á–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏

#### –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)
```bash
python scripts/train_cluster_model.py
```

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
```bash
# –° Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
python scripts/train_with_walk_forward.py --enable-walk-forward

# –° –º—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
python scripts/train_with_walk_forward.py --enable-multiframe

# –° –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π ATR –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
python scripts/train_with_walk_forward.py --optimize-atr

# –í—Å—ë –≤–º–µ—Å—Ç–µ
python scripts/train_with_walk_forward.py \
    --enable-walk-forward \
    --enable-multiframe \
    --optimize-atr
```

### 4. –≠–∫—Å–ø–æ—Ä—Ç –≤ MT5

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è:
- ONNX –º–æ–¥–µ–ª–∏ ‚Üí `models/exported/`
- Include —Ñ–∞–π–ª—ã ‚Üí `models/exported/`
- –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ MT5: `MQL5/Experts/` –∏ `MQL5/Include/`

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `config/training_config.yaml`:

```yaml
symbol:
  name: XAUUSD_H1
  timeframe: H1

direction: buy  # –∏–ª–∏ sell

# NEW: –ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º
data:
  multiframe:
    enabled: true
    timeframes: ['D1', 'W1', 'MN']

# NEW: ATR –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
trading:
  risk:
    atr_sl_multiplier: 2.0
    atr_tp_multiplier: 2.5
    risk_per_trade: 0.005  # 0.5%

# –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
target_val_acc: 0.75
target_r2: 0.95
max_iterations: 40
```

---

## üìä –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è (6 —ç—Ç–∞–ø–æ–≤)

### –≠—Ç–∞–ø 1: –ü–µ—Ä–µ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚úÖ
- –ó–∞–≥—Ä—É–∑–∫–∞ OHLCV –¥–∞–Ω–Ω—ã—Ö
- –ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (NEW)
- –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º —à—Ç—Ä–∞—Ñ–æ–º

### –≠—Ç–∞–ø 2: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —á–µ–∫–ø–æ–∏–Ω—Ç—ã ‚úÖ (NEW)
- 10 –±–ª–æ–∫–æ–≤ In-Sample
- 5 –±–ª–æ–∫–æ–≤ Out-of-Sample (—Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)
- Walk-forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å —Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–∞—Ö

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ ‚úÖ (–û–ë–ù–û–í–õ–ï–ù–û)
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SL/TP –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR** (NEW)
- SL = Entry ¬± 2.0 * ATR
- TP = Entry ¬± 2.5 * ATR
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
- –®—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ–∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏

### –≠—Ç–∞–ø 4: –û—Ç–±–æ—Ä –º–æ–¥–µ–ª–∏ ‚úÖ
- –ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö OOS-–±–ª–æ–∫–æ–≤
- Out-of-Time —Ç–µ—Å—Ç (—Å–∞–º—ã–µ —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ)
- –ö—Ä–∏—Ç–µ—Ä–∏–π: –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å > 0, Drawdown < 10%

### –≠—Ç–∞–ø 5: Live-–≤–∞–ª–∏–¥–∞—Ü–∏—è ‚úÖ
- –î–µ–º–æ-—Å—á–µ—Ç –º–∏–Ω–∏–º—É–º 6 –º–µ—Å—è—Ü–µ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ç–æ–∂–∏–¥–∞–Ω–∏—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–æ—Å–∞–¥–∫–∏

### –≠—Ç–∞–ø 6: –°–∏—Å—Ç–µ–º–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ ‚úÖ (NEW)
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (NEW)
- –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ –ø—Ä–æ—Å–∞–¥–∫—É > 120% –æ—Ç OOT
- –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ 10 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –ø–æ–¥—Ä—è–¥
- –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ –ø–∞–¥–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏ < 50%
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### Walk-Forward Validator (NEW)
```python
from src.validation.walk_forward import WalkForwardValidator, WalkForwardConfig

config = WalkForwardConfig(
    n_is_blocks=10,
    n_oos_blocks=5,
    min_ppt=0.0,
    max_drawdown=0.05,
    max_retries=3
)

validator = WalkForwardValidator(config)
success, results = validator.validate_sequential(train_fn, eval_fn, params)
```

### ATR Risk Manager (NEW)
```python
from src.risk.atr_manager import ATRRiskManager

manager = ATRRiskManager(
    sl_multiplier=2.0,
    tp_multiplier=2.5,
    risk_per_trade=0.005
)

# –†–∞—Å—á–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π
levels = manager.calculate_levels(
    entry_price=1800.0,
    atr_value=5.0,
    direction='buy'
)

print(f"SL: {levels['sl']}, TP: {levels['tp']}")
```

### Degradation Monitor (NEW)
```python
from src.monitoring.degradation import DegradationMonitor

monitor = DegradationMonitor(historical_metrics)

# –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏
status = monitor.update(trade_result)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
should_stop, reasons = monitor.should_stop_trading()
if should_stop:
    print("üõë –¢–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!")
    for reason in reasons:
        print(f"  ‚Ä¢ {reason}")
```

### Multiframe Features (NEW)
```python
from src.features.multiframe import create_multiframe_features

df = create_multiframe_features(
    data_path='./data/raw',
    symbol='XAUUSD',
    primary_tf='H1',
    context_tfs=['D1', 'W1', 'MN']
)
```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –ù–æ–≤–æ–µ –≤ v1.1 |
|---------|------------------|--------------|
| **Val Accuracy** | ‚â•75% | |
| **R¬≤** | ‚â•0.95 | |
| **–ü—Ä–æ—Å–∞–¥–∫–∞ (OOS)** | ‚â§5% | |
| **–ü—Ä–æ—Å–∞–¥–∫–∞ (OOT)** | ‚â§7-10% | |
| **Walk-Forward Pass Rate** | 100% (–≤—Å–µ 5 –±–ª–æ–∫–æ–≤) | ‚úÖ NEW |
| **ATR Optimization** | R/R ‚â• 1.25 | ‚úÖ NEW |
| **Degradation Triggers** | 0 –∞–∫—Ç–∏–≤–Ω—ã—Ö | ‚úÖ NEW |

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (NEW)
```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest tests/test_new_modules.py -v

# –¢–æ–ª—å–∫–æ Walk-Forward
pytest tests/test_new_modules.py::TestWalkForwardValidator -v

# –¢–æ–ª—å–∫–æ ATR
pytest tests/test_new_modules.py::TestATRRiskManager -v

# –¢–æ–ª—å–∫–æ Degradation
pytest tests/test_new_modules.py::TestDegradationMonitor -v
```

### –ë—ç–∫—Ç–µ—Å—Ç —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
```python
from src.risk.atr_manager import backtest_with_dynamic_atr

manager = ATRRiskManager()
results = backtest_with_dynamic_atr(
    data,
    signals,
    direction='buy',
    manager=manager
)

print(f"Win Rate: {results['win_rate']:.2%}")
print(f"Total Profit: {results['total_profit']:.2f}")
```

---

## üõ°Ô∏è –†–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç

### –í –æ–±—É—á–µ–Ω–∏–∏:
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SL/TP** (NEW): –ù–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ ATR
- `Stop-Loss = Entry ¬± 2.0 * ATR`
- `Take-Profit = Entry ¬± 2.5 * ATR`
- –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ —Ç–∞–π–º–∞—É—Ç—É: 20 –±–∞—Ä–æ–≤

### –í —Ç–æ—Ä–≥–æ–≤–ª–µ (MT5):
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏** (NEW): Position = (Capital * Risk%) / SL_Distance
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∏—Å–∫ 0.5% –æ—Ç –∫–∞–ø–∏—Ç–∞–ª–∞
- –ú–∞–∫—Å–∏–º—É–º –ø–æ–∑–∏—Ü–∏–π: 3
- –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —Å–¥–µ–ª–∫–∞–º–∏: 5 —á–∞—Å–æ–≤
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å–ø—Ä–µ–¥: 25 –ø—É–Ω–∫—Ç–æ–≤

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è)

```
FuncXauusd/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ validation/           # ‚úÖ NEW: Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ walk_forward.py
‚îÇ   ‚îú‚îÄ‚îÄ risk/                 # ‚úÖ NEW: ATR —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ atr_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ monitoring/           # ‚úÖ NEW: –°–∏—Å—Ç–µ–º–∞ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ degradation.py
‚îÇ   ‚îú‚îÄ‚îÄ features/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ engineering.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ multiframe.py    # ‚úÖ NEW: –ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ labeling/
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ export/
‚îÇ   ‚îî‚îÄ‚îÄ backtesting/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ train_cluster_model.py        # –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
‚îÇ   ‚îî‚îÄ‚îÄ train_with_walk_forward.py   # ‚úÖ NEW: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ tests/                    # ‚úÖ NEW: –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ test_new_modules.py
‚îî‚îÄ‚îÄ ...
```

---

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MT5

### –°–æ–≤–µ—Ç–Ω–∏–∫: `OneDirectionBot.mq5`
- –ó–∞–≥—Ä—É–∑–∫–∞ ONNX –º–æ–¥–µ–ª–µ–π —á–µ—Ä–µ–∑ `OnnxCreateFromBuffer()`
- –†–∞—Å—á–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º –±–∞—Ä–µ
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ SL/TP** (—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ MQL –∫–æ–¥–∞)
- –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ —Å–∏–≥–Ω–∞–ª–∞–º
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### v1.0 (–æ—Ä–∏–≥–∏–Ω–∞–ª)
1. **–î–∞–Ω–Ω—ã–µ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π** - –∑–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑ MetaTrader
2. **–ú–æ–¥–µ–ª–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω—ã** - –æ–±—É—á–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ
3. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –¥–µ–º–æ** - –º–∏–Ω–∏–º—É–º 6 –º–µ—Å—è—Ü–µ–≤ –ø–µ—Ä–µ–¥ —Ä–µ–∞–ª—å–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ–π

### v1.1 (–Ω–æ–≤–æ–µ)
4. **Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞** - –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ—Ç —ç—Ç–∞–ø
5. **ATR –º–Ω–æ–∂–∏—Ç–µ–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--optimize-atr`
6. **Degradation Monitor –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** - –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ live —Ç–æ—Ä–≥–æ–≤–ª—é
7. **–ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è** - –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è

---

## üìù TODO –¥–ª—è –±—É–¥—É—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

### v1.2 (–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –∫–∞–∂–¥—ã–µ 6 –º–µ—Å—è—Ü–µ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] Dashboard –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Streamlit/Dash)
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (>80%)
- [ ] CI/CD pipeline (GitHub Actions)
- [ ] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Sphinx)

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [Implementation Plan](docs/implementation_plan.md) - –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (6 —ç—Ç–∞–ø–æ–≤)
- [Project Structure](PROJECT_STRUCTURE.md) - –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [Walk-Forward Guide](docs/walk_forward_guide.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Walk-Forward (TODO)
- [ATR Risk Management](docs/atr_guide.md) - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ ATR (TODO)
- [Degradation Monitoring](docs/degradation_guide.md) - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ (TODO)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Proprietary - For internal hedge fund use only

---

## üë§ –ê–≤—Ç–æ—Ä

Trading Systems Engineering Team

---

**‚ö° –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:** Production-ready v1.1  
**üéØ –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è:** 1.1.0  
**üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-03

---

## üÜï Changelog v1.1

### –î–æ–±–∞–≤–ª–µ–Ω–æ
- ‚úÖ Walk-Forward –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º–∏
- ‚úÖ ATR Risk Manager —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ SL/TP
- ‚úÖ Degradation Monitor —Å –∞–≤—Ç–æ–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π
- ‚úÖ –ú—É–ª—å—Ç–∏—Ñ—Ä–µ–π–º–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (1m - 1Month)
- ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è `train_with_walk_forward.py`
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏: `validation/`, `risk/`, `monitoring/`

### –ò–∑–º–µ–Ω–µ–Ω–æ
- üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (README, implementation_plan.md)
- üîÑ –£–ª—É—á—à–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- üîÑ –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –≤ `src/__init__.py`

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- üêõ CSV –ø–∞—Ä—Å–µ—Ä —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã MT5
- üêõ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ –º–æ–¥—É–ª—è—Ö

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–æ–¥–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `train_with_walk_forward.py`.